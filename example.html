<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>L.HighlightableLayers Example</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
		<style type="text/css">
			html, body { width: 100%; height: 100%; margin: 0; }
			#map { width: 100%; height: 100%; }
		</style>
	</head>

	<body>
		<div id="map"></div>
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
		<script type="text/javascript" src="dist/L.HighlightableLayers.js"></script>

		<script type="text/javascript">
		    var map = L.map('map',{
				center: [52.4830, 13.3414],
				zoom: 9
			});
		    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
				attribution: 'Â© <a href="http://www.openstreetmap.org/copyright" target="_blank">OSM Contributors</a>',
				noWrap: true
			}).addTo(map);

			const layers = [
				new L.HighlightableLayers.HighlightablePolyline([[53.09897, 12.02728], [52.01701, 14.18884]], { weight: 10 }).addTo(map),

				// Test empty polyline, setting coordinates later
				new L.HighlightableLayers.HighlightablePolyline([], { color: '#ffffff', weight: 3 }).addTo(map),

				new L.HighlightableLayers.HighlightablePolygon([[52.32359, 13.92242], [52.11157, 13.28522], [51.87649, 13.98834]]).addTo(map),
				new L.HighlightableLayers.HighlightablePolyline([[52.06262, 12.55737], [51.98995, 14.1394]], {
					generateStyles: (options, renderer) => ({
						main: { opacity: 0, weight: 30, pane: 'lhl-almost-over' },
						line1: { ...options, color: '#0000ff', weight: 30, renderer },
						line2: { ...options, color: '#00ff00', weight: 20, renderer },
						line3: { ...options, color: '#ff0000', weight: 10, renderer }
					})
				}).addTo(map),
				new L.HighlightableLayers.HighlightableCircle([52.54463, 11.68121], { radius: 10000, color: "#ffff00" }).addTo(map),
				new L.HighlightableLayers.HighlightableRectangle([[52.91056, 14.40308], [52.63806, 15.0705]], { color: "#ffaaaa" }).addTo(map)
			];

			// Test updating geometry
			layers[1].setLatLngs([[51.96119, 11.79382], [53.16653, 14.04877]]);
			layers[4].setRadius(20000);

			function setHighlightedLayer(layer) {
				for (const l of layers) {
					l.setStyle({ opacity: l === layer ? 0.8 : 0.35, raised: l === layer, outlineFill: l === layer });
				}
			}

			for (const layer of layers) {
				layer.on('click', (e) => { setTimeout(() => {
					setHighlightedLayer(layer);
				}, 0); });
			}

			map.on('click', (e) => {
				setHighlightedLayer(null);
			});

			setHighlightedLayer(null);
		</script>
	</body>
</html>
